<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Patients Check-in - Staff</title>
  <link rel="stylesheet" href="../css/style.css" />
  <link rel="stylesheet" href="./patients_staff.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body>
  <button class="hamburger" id="hamburger">â˜°</button>
  <div class="container">
    <aside class="sidebar" id="sidenav">
      <div class="logo" id="logo">
        <img src="../images/dark_logo.png" alt="UCNIACARE Logo" id="logo-img" />
      </div>
      <nav class="menu" id="menu">
        <ul>
          <li><a href="dashboard_staff.html" id="nav-dashboard"><i class="fa-solid fa-house"></i>Dashboard</a></li>
          <li><a href="patients_staff.html" id="nav-patients" style="background:#e6f0ff;color:#0056b3;"><i class="fa-solid fa-users"></i>Patients</a></li>
          <li><a href="inventory_staff.html" id="nav-inventory"><i class="fa-solid fa-box"></i>Inventory</a></li>
          <li><a href="settings_staff.html" id="nav-settings"><i class="fa-solid fa-gear"></i>Settings</a></li>
        </ul>
      </nav>
    </aside>

    <main class="main-content" id="main">
      <header class="header">
        <h1 class="page_title">Patient</h1>
        
        <div class="header-right">
          <!-- Notification Icon -->
          <div class="notification-icon">
            <i class="fa-solid fa-bell"></i>
            <span class="badge"></span>
          </div>
          
          <!-- User Profile -->
          <div class="user-profile">
            <div class="user-avatar">ST</div>
            <div class="user-info">
              <p class="user-name">Staff User</p>
              <p class="user-role">Front Desk</p>
            </div>
          </div>
        </div>
      </header>
      <div class="content" id="patients-content">
        <nav id="patients-tabs">
          <a href="#" id="tab-checkin" class="active">Check - in</a>
          <a href="#" id="tab-cliniclogs">Clinic-Logs</a>
          <a href="#" id="tab-referral">Referral</a>
          <a href="#" id="tab-basic">Basic Assessment</a>
        </nav>

        <section class="card" id="queue-card">
          <div class="queue-top" id="queue-top">
            <h2 id="queue-title">Queue</h2>
            <div class="queue-actions" id="queue-actions">
              <a href="#checkin-modal" id="open-checkin" class="green-btn">Check -in</a>
              <div class="search" id="queue-search">
                <input type="text" id="search-patient" placeholder="Patient Name" />
                <button id="search-btn" aria-label="Search"><i class="fa-solid fa-magnifying-glass"></i></button>
              </div>
            </div>
          </div>

          <div class="table-wrapper" id="queue-wrapper">
            <table id="queue-table">
              <thead>
                <tr>
                  <th id="col-patient">Patient</th>
                  <th id="col-queueno">Queue no.</th>
                  <th id="col-purpose">Purpose</th>
                  <th id="col-type">Type</th>
                  <th id="col-action">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Nick Young</td>
                  <td>01</td>
                  <td>Consultation</td>
                  <td>Appointment</td>
                  <td><button class="icon-btn" id="act-1"><i class="fa-solid fa-user-plus"></i></button></td>
                </tr>
                <tr>
                  <td>Encho Lee</td>
                  <td>N/A</td>
                  <td>Consultation</td>
                  <td>Walk - in</td>
                  <td><button class="icon-btn" id="act-2"><i class="fa-solid fa-user-plus"></i></button></td>
                </tr>
                <tr>
                  <td>Gwen Fiel</td>
                  <td>02</td>
                  <td>Consultation</td>
                  <td>Walk - in</td>
                  <td><button class="icon-btn" id="act-3"><i class="fa-solid fa-user-plus"></i></button></td>
                </tr>
                <tr>
                  <td>Kim Jisoo</td>
                  <td>03</td>
                  <td>Intramurals</td>
                  <td>Walk - in</td>
                  <td><button class="icon-btn" id="act-4"><i class="fa-solid fa-user-plus"></i></button></td>
                </tr>
                <tr>
                  <td>Wincy Yee</td>
                  <td>04</td>
                  <td>Physical Exam.</td>
                  <td>Walk - in</td>
                  <td><button class="icon-btn" id="act-5"><i class="fa-solid fa-user-plus"></i></button></td>
                </tr>
                <tr>
                  <td>Nancy Romales</td>
                  <td>05</td>
                  <td>Follow - up</td>
                  <td>Appointment</td>
                  <td><button class="icon-btn" id="act-6"><i class="fa-solid fa-user-plus"></i></button></td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>
        
        <!-- Clinic Logs Section -->
        <section class="card" id="clinic-logs-card" style="display: none;">
          <div class="logs-header" id="logs-header">
            <h2 id="logs-title">Logs</h2>
            <div class="logs-actions" id="logs-actions">
              <div class="search" id="logs-search">
                <input type="text" id="search-logs" placeholder="Search" />
                <button id="logs-search-btn" aria-label="Search"><i class="fa-solid fa-magnifying-glass"></i></button>
              </div>
              <button class="filter-btn" id="filter-btn">
                <i class="fa-solid fa-filter"></i>
                Filter
              </button>
            </div>
          </div>

          <!-- Filter Section -->
          <div class="filter-section" id="filter-section" style="display: none;">
            <div class="filter-row">
              <div class="filter-group">
                <label for="filter-users">All Users</label>
                <select id="filter-users" class="filter-select">
                  <option value="">All Users</option>
                  <option value="nick">Nick Young</option>
                  <option value="encho">Encho Lee</option>
                  <option value="gwen">Gwen Fiel</option>
                  <option value="kim">Kim Jisoo</option>
                  <option value="wincy">Wincy Yee</option>
                  <option value="nancy">Nancy Romales</option>
                </select>
              </div>
              
              <div class="filter-group">
                <label for="filter-date">Date & Time</label>
                <select id="filter-date" class="filter-select">
                  <option value="">All Dates</option>
                  <option value="today">Today</option>
                  <option value="yesterday">Yesterday</option>
                  <option value="week">This Week</option>
                  <option value="month">This Month</option>
                  <option value="custom">Custom Range</option>
                </select>
              </div>
              
              <div class="filter-group">
                <label for="filter-status">All Status</label>
                <select id="filter-status" class="filter-select">
                  <option value="">All Status</option>
                  <option value="ongoing">Ongoing</option>
                  <option value="completed">Completed</option>
                  <option value="referred">Referred</option>
                  <option value="absent">Absent</option>
                </select>
              </div>
              
              <div class="filter-group">
                <label for="filter-affiliation">All Affiliation</label>
                <select id="filter-affiliation" class="filter-select">
                  <option value="">All Affiliation</option>
                  <option value="bsit">BSIT</option>
                  <option value="bshm">BSHM</option>
                  <option value="bscs">BSCS</option>
                  <option value="beed">BEED</option>
                </select>
              </div>
            </div>
            
            <div class="filter-actions">
              <button type="button" id="apply-filter" class="apply-filter-btn">Apply Filter</button>
              <button type="button" id="close-filter" class="close-filter-btn">Close</button>
            </div>
          </div>

          <div class="table-wrapper" id="logs-wrapper">
            <table id="logs-table">
              <thead>
                <tr>
                  <th id="col-patient-logs">Patient</th>
                  <th id="col-course">Course & Yr</th>
                  <th id="col-purpose-logs">Purpose</th>
                  <th id="col-status">Status</th>
                  <th id="col-action-logs">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Nick Young</td>
                  <td>BSIT - 4</td>
                  <td>Consultation</td>
                  <td><span class="status-badge ongoing">Ongoing</span></td>
                  <td><button class="view-btn" id="view-1">View</button></td>
                </tr>
                <tr>
                  <td>Encho Lee</td>
                  <td>BSHM - 1</td>
                  <td>Consultation</td>
                  <td><span class="status-badge ongoing">Ongoing</span></td>
                  <td><button class="view-btn" id="view-2">View</button></td>
                </tr>
                <tr>
                  <td>Gwen Fiel</td>
                  <td>BSIT - 2</td>
                  <td>Consultation</td>
                  <td><span class="status-badge completed">Completed</span></td>
                  <td><button class="view-btn" id="view-3">View</button></td>
                </tr>
                <tr>
                  <td>Kim Jisoo</td>
                  <td>BSCS - 4</td>
                  <td>Intramurals</td>
                  <td><span class="status-badge referred">Referred</span></td>
                  <td><button class="view-btn" id="view-4">View</button></td>
                </tr>
                <tr>
                  <td>Wincy Yee</td>
                  <td>BEED - 1</td>
                  <td>Physical Exam.</td>
                  <td><span class="status-badge ongoing">Ongoing</span></td>
                  <td><button class="view-btn" id="view-5">View</button></td>
                </tr>
                <tr>
                  <td>Nancy Romales</td>
                  <td>BSHM - 4</td>
                  <td>Consultation</td>
                  <td><span class="status-badge absent">Absent</span></td>
                  <td><button class="view-btn" id="view-6">View</button></td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>
        
        <!-- Referral Section -->
        <section class="card" id="referral-card" style="display: none;">
          <div class="referral-header">
            <h2>Referral</h2>
          </div>
          <nav class="referral-tabs" id="referral-tabs">
            <a href="#" id="ref-tab-create" class="active">Create</a>
            <a href="#" id="ref-tab-pending">Pending</a>
            <a href="#" id="ref-tab-approved">Approved</a>
          </nav>

          <!-- Create Referral Form -->
          <div id="referral-create" class="referral-panel" style="display: block;">
            <form id="referral-form" autocomplete="off">
              <div class="ref-row">
                <label class="ref-label">Purpose for Referral :</label>
                <select class="ref-select" id="ref-purpose">
                  <option value="" selected>Referral Purpose</option>
                  <option value="laboratory">Laboratory Request</option>
                  <option value="specialist">Specialist Consultation</option>
                  <option value="imaging">Imaging / X-ray</option>
                </select>
              </div>

              <div class="ref-grid-3">
                <div class="ref-field">
                  <label class="ref-label">Name :</label>
                  <input class="ref-input" id="ref-name" type="text" placeholder="Enter Patient Name" />
                </div>
                <div class="ref-field">
                  <label class="ref-label">Age :</label>
                  <input class="ref-input" id="ref-age" type="number" placeholder="" />
                </div>
                <div class="ref-field">
                  <label class="ref-label">Sex :</label>
                  <select class="ref-select" id="ref-sex">
                    <option value="">Select</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                  </select>
                </div>
              </div>

              <div class="ref-row">
                <label class="ref-label">Address :</label>
                <input class="ref-input" id="ref-address" type="text" placeholder="" />
              </div>

              <div class="ref-row">
                <label class="ref-label">Referred to :</label>
                <input class="ref-input" id="ref-to" type="text" placeholder="Enter Hospital / Clinic Name" />
              </div>

              <div class="ref-request">
                <label class="ref-label">Request for :</label>
                <div class="ref-checkbox-grid">
                  <label class="ref-check"><input type="checkbox" value="cxr"> Chest X-ray PA Viewer</label>
                  <label class="ref-check"><input type="checkbox" value="hbsag"> HBS Ag</label>
                  <label class="ref-check"><input type="checkbox" value="urinalysis"> Urinalysis</label>
                  <label class="ref-check"><input type="checkbox" value="fecalysis"> Fecalysis</label>
                  <label class="ref-check"><input type="checkbox" value="cbc"> CBC</label>
                  <label class="ref-check"><input type="checkbox" value="ecg"> ECG</label>
                  <label class="ref-check"><input type="checkbox" value="drugtest"> Drug Test</label>
                </div>
              </div>

              <div class="ref-row">
                <label class="ref-label">Other :</label>
                <select class="ref-select" id="ref-other">
                  <option value="" selected>Other Laboratory</option>
                  <option value="sugar">Blood Sugar</option>
                  <option value="lipid">Lipid Profile</option>
                </select>
              </div>

              <div class="ref-actions">
                <button type="button" id="ref-submit" class="ref-submit">SUBMIT FOR APPROVAL</button>
              </div>
            </form>
          </div>

          <!-- Pending List -->
          <div id="referral-pending" class="referral-panel" style="display: none;">
            <div class="table-wrapper">
              <table id="referral-table-pending">
                <thead>
                  <tr>
                    <th>Patient</th>
                    <th>Purpose</th>
                    <th>Referred To</th>
                    <th>Status</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Nancy Romales</td>
                    <td>Laboratory Request</td>
                    <td>City Hospital</td>
                    <td><span class="status-badge referred">Pending</span></td>
                    <td><button class="view-btn">View</button></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Approved List -->
          <div id="referral-approved" class="referral-panel" style="display: none;">
            <div class="table-wrapper">
              <table id="referral-table-approved">
                <thead>
                  <tr>
                    <th>Patient</th>
                    <th>Purpose</th>
                    <th>Referred To</th>
                    <th>Status</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Nick Young</td>
                    <td>Laboratory Request</td>
                    <td>City Medical Center</td>
                    <td><span class="status-badge completed">Approved</span></td>
                    <td><button class="view-btn" onclick="showReferralSlip('Nick Young', 'Laboratory Request', 'City Medical Center', ['Urinalysis', 'CBC'])">View</button></td>
                  </tr>
                  <tr>
                    <td>Gwen Fiel</td>
                    <td>Imaging / X-ray</td>
                    <td>Radiology Center</td>
                    <td><span class="status-badge completed">Approved</span></td>
                    <td><button class="view-btn" onclick="showReferralSlip('Gwen Fiel', 'Imaging / X-ray', 'Radiology Center', ['Chest X-ray PA View'])">View</button></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </section>
        
        <!-- Basic Assessment Section -->
        <section class="card" id="basic-assessment-card" style="display: none;">
          <div class="basic-assessment-header">
            <h2>Basic Assessment</h2>
          </div>
          
          <!-- Queue Section -->
          <div class="assessment-queue">
            <div class="queue-section-title">Queue</div>
            <div class="queue-cards">
              <div class="queue-card">
                <div class="queue-info">
                  <div class="queue-number">Queue #1</div>
                  <div class="patient-name">Nancy Romales</div>
                  <div class="assessment-type">Physical Examination</div>
                </div>
                <button class="assess-btn">Assess</button>
              </div>
              <div class="queue-card">
                <div class="queue-info">
                  <div class="queue-number">Queue #2</div>
                  <div class="patient-name">Wincy Romales</div>
                  <div class="assessment-type">Medical Certificate</div>
                </div>
                <button class="assess-btn">Assess</button>
              </div>
              <div class="queue-card">
                <div class="queue-info">
                  <div class="queue-number">Queue #3</div>
                  <div class="patient-name">Glenn Romales</div>
                  <div class="assessment-type">Consultation</div>
                </div>
                <button class="assess-btn">Assess</button>
              </div>
              <div class="queue-card">
                <div class="queue-info">
                  <div class="queue-number">Queue #4</div>
                  <div class="patient-name">Rachelle Fiel</div>
                  <div class="assessment-type">Annual Physical Examination</div>
                </div>
                <button class="assess-btn">Assess</button>
              </div>
            </div>
            <div class="queue-navigation">
              <button class="nav-arrow">&lt;</button>
              <button class="nav-arrow">&gt;</button>
            </div>
          </div>
          
          <!-- Patient Information Section -->
          <div class="patient-information-section">
            <div class="patient-info-grid">
              <div class="info-column">
                <div class="info-field">
                  <div class="info-label">NAME:</div>
                  <div class="info-value underlined">Nancy Romales</div>
                </div>
                <div class="info-field">
                  <div class="info-label">ADDRESS:</div>
                  <div class="info-value underlined">Sitio Guinabsan, Basak San Nicolas</div>
                </div>
                <div class="info-field">
                  <div class="info-label">CONTACT NO:</div>
                  <div class="info-value underlined" style="color: red;">09310159072</div>
                </div>
                <div class="info-field">
                  <div class="info-label" style="color: red;">In case of emergency, pls notify:</div>
                </div>
                <div class="info-field">
                  <div class="info-label">NAME OF PARENT / GUARDIAN:</div>
                  <div class="info-value underlined">Glenacy Romales</div>
                </div>
                <div class="info-field">
                  <div class="info-label">TEL. NO / CELL NO.:</div>
                  <div class="info-value underlined">09225265408</div>
                </div>
                <div class="info-field">
                  <div class="info-label">RELATIONSHIP:</div>
                  <div class="info-value underlined">Mother</div>
                </div>
              </div>
              <div class="info-column">
                <div class="info-field">
                  <div class="info-label">I.D. NO:</div>
                  <div class="info-value underlined">22599559</div>
                </div>
                <div class="info-field">
                  <div class="info-label">AGE:</div>
                  <div class="info-value underlined">21</div>
                </div>
                <div class="info-field">
                  <div class="info-label">SEX:</div>
                  <div class="info-value underlined">Female</div>
                </div>
                <div class="info-field">
                  <div class="info-label">STATUS:</div>
                  <div class="info-value underlined">Single</div>
                </div>
                <div class="info-field">
                  <div class="info-label">BIRTHDATE:</div>
                  <div class="info-value underlined">09/10/03</div>
                </div>
                <div class="info-field">
                  <div class="info-label">COURSE & YR:</div>
                  <div class="info-value underlined">BSIT - 4</div>
                </div>
                <div class="info-field">
                  <div class="info-label">TOA:</div>
                  <input type="text" class="info-input" placeholder="">
                </div>
              </div>
            </div>
          </div>
          
          <!-- Vital Signs Section -->
          <div class="vital-signs-section">
            <h3>Vital Signs</h3>
            <div class="vital-signs-grid">
              <div class="vital-field">
                <div class="vital-label">Blood Pressure *</div>
                <input type="text" class="vital-input" placeholder="">
              </div>
              <div class="vital-field">
                <div class="vital-label">Pulse Rate *</div>
                <input type="text" class="vital-input" placeholder="">
              </div>
              <div class="vital-field">
                <div class="vital-label">Temperature *</div>
                <input type="text" class="vital-input" placeholder="">
              </div>
              <div class="vital-field">
                <div class="vital-label">SP02 *</div>
                <input type="text" class="vital-input" placeholder="">
              </div>
              <div class="vital-field">
                <div class="vital-label">RR *</div>
                <input type="text" class="vital-input" placeholder="">
              </div>
            </div>
          </div>
          
          <!-- Anthropometric Measurements Section -->
          <div class="anthropometric-section">
            <h3>Anthropometric Measurements</h3>
            <div class="anthropometric-grid">
              <div class="anthropometric-field">
                <div class="anthropometric-label">Height *</div>
                <input type="text" class="anthropometric-input" placeholder="">
              </div>
              <div class="anthropometric-field">
                <div class="anthropometric-label">Weight *</div>
                <input type="text" class="anthropometric-input" placeholder="">
              </div>
              <div class="anthropometric-field">
                <div class="anthropometric-label">BMI *</div>
                <input type="text" class="anthropometric-input" placeholder="">
              </div>
            </div>
          </div>
          
          <!-- Submit Button -->
          <div class="assessment-actions">
            <button class="submit-assessment-btn">SUBMIT</button>
          </div>
        </section>
        
        <!-- Check-in Modal (CSS-only via :target) -->
        <div id="checkin-modal" class="modal-overlay">
          <div class="modal-dialog" role="dialog" aria-labelledby="modal-title" aria-modal="true">
            <a href="#" class="modal-close" id="modal-close" aria-label="Close">&times;</a>
            <h3 class="modal-title" id="modal-title">Patient Check - In</h3>
            <div id="search-section">
              <p class="modal-subtext" id="modal-subtext">Enter Patient ID number to search</p>
              <form id="checkin-search-form" action="#">
                <div class="modal-search" id="modal-search">
                  <input type="text" id="checkin-id" placeholder="ID Number" />
                  <button type="button" id="modal-search-btn" aria-label="Search"><i class="fa-solid fa-magnifying-glass"></i></button>
                </div>
              </form>
            </div>
            
            <div id="patient-section" style="display: none;">
              <div class="patient-info" id="patient-info">
                <h4 class="section-title" id="patient-info-title">Patient Information</h4>
                <div class="patient-details" id="patient-details">
                  <div class="patient-avatar" id="patient-avatar">
                    <i class="fa-solid fa-user"></i>
                  </div>
                  <div class="patient-text" id="patient-text">
                    <p><strong>NAME:</strong> <span id="patient-name">Nancy Romales</span></p>
                    <p><strong>COURSE & YR:</strong> <span id="patient-course">BSIT - 4</span></p>
                    <p><strong>AGE:</strong> <span id="patient-age">21</span></p>
                    <p><strong>SEX:</strong> <span id="patient-sex">FEMALE</span></p>
                  </div>
                </div>
              </div>
              
              <div class="purpose-section" id="purpose-section">
                <h4 class="section-title" id="purpose-title">Purpose of Visit</h4>
                <select id="purpose-select">
                  <option value="">Select Purpose of Visit</option>
                  <option value="consultation">Consultation</option>
                  <option value="follow-up">Follow-up</option>
                  <option value="physical-exam">Physical Examination</option>
                  <option value="sick-leave">Sick Leave</option>
                  <option value="intramurals">Intramurals</option>
                </select>
              </div>
              
              <div class="modal-actions" id="modal-actions">
                <button type="button" id="btn-cancel" class="btn-cancel">CANCEL</button>
                <a href="#guardian-modal" id="btn-next" class="btn-next">NEXT</a>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Guardian & Medical Documents Modal -->
        <div id="guardian-modal" class="modal-overlay">
          <div class="modal-dialog guardian-dialog" role="dialog" aria-labelledby="guardian-title" aria-modal="true">
            <a href="#" class="modal-close" id="guardian-close" aria-label="Close">&times;</a>
            <h3 class="modal-title" id="guardian-title">Patient Check - In</h3>
            
            <div class="guardian-section" id="guardian-section">
              <h4 class="section-title" id="guardian-question">Is the patient with a guardian ?</h4>
              <div class="radio-group" id="guardian-radio">
                <label><input type="radio" name="guardian" value="yes" id="guardian-yes" /> Yes</label>
                <label><input type="radio" name="guardian" value="no" id="guardian-no" /> No</label>
              </div>
              
              <div id="guardian-details" style="display: none;">
                <h4 class="section-title" id="guardian-details-title">Guardian Information</h4>
                <div class="guardian-inputs" id="guardian-inputs">
                  <input type="text" id="guardian-name" placeholder="Guardian Name" />
                  <input type="text" id="guardian-relationship" placeholder="Relationship" />
                </div>
              </div>
            </div>
            
            <div class="documents-section" id="documents-section">
              <h4 class="section-title" id="documents-question">Does the patient have any medical documents to share ?</h4>
              <div class="radio-group" id="documents-radio">
                <label><input type="radio" name="documents" value="yes" id="documents-yes" /> Yes</label>
                <label><input type="radio" name="documents" value="no" id="documents-no" /> No</label>
              </div>
              
              <div id="upload-section" style="display: none;">
                <h4 class="section-title" id="upload-title">Upload Documents here</h4>
                <div class="upload-area" id="upload-area">
                  <i class="fa-solid fa-arrow-up"></i>
                  <p>Upload Documents here</p>
                  <button type="button" id="choose-files">Choose Files</button>
                  <p class="file-types">PDF, PNG, JPG, DOC, DOCX</p>
                </div>
                <div class="uploaded-files" id="uploaded-files">
                  <h5>Uploaded Documents (1)</h5>
                  <div class="file-item" id="file-item">
                    <i class="fa-solid fa-file"></i>
                    <span>lab_results.png</span>
                    <span class="file-size">73.8 KB</span>
                    <button type="button" class="remove-file" id="remove-file">&times;</button>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="modal-actions" id="guardian-actions">
              <a href="#checkin-modal" id="btn-back" class="btn-back">BACK</a>
              <button type="button" id="btn-checkin-final" class="btn-checkin-final">CHECK - IN</button>
            </div>
          </div>
        </div>
        
        <!-- Success Message Modal -->
        <div id="success-modal" class="modal-overlay success-overlay">
          <div class="modal-dialog success-dialog" role="dialog" aria-labelledby="success-title" aria-modal="true">
            <div class="success-content">
              <div class="success-icon">
                <i class="fa-solid fa-check"></i>
              </div>
              <h3 class="success-title" id="success-title">Patient Checked - In Successfully!</h3>
            </div>
          </div>
        </div>
        
        <!-- Referral Success Message Modal -->
        <div id="referral-success-modal" class="modal-overlay success-overlay">
          <div class="modal-dialog success-dialog" role="dialog" aria-labelledby="referral-success-title" aria-modal="true">
            <div class="success-content">
              <div class="success-icon">
                <i class="fa-solid fa-check"></i>
              </div>
              <h3 class="success-title" id="referral-success-title">Referral Submitted Successfully!</h3>
            </div>
          </div>
        </div>
        
        <!-- Referral Slip Modal -->
        <div id="referral-slip-modal" class="modal-overlay">
          <div class="modal-dialog referral-slip-dialog" role="dialog" aria-labelledby="referral-slip-title" aria-modal="true">
            <a href="#" class="modal-close" id="referral-slip-close" aria-label="Close">&times;</a>
            <div class="referral-slip-content" id="referral-slip-content">
              <!-- Referral slip content will be populated here -->
            </div>
            <div class="referral-slip-actions">
              <button type="button" id="print-referral" class="print-icon" title="Print Referral Slip">
                <i class="fa-solid fa-print"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  
  <script>
    // Tab switching functionality
    document.getElementById('tab-checkin').addEventListener('click', function(e) {
      e.preventDefault();
      
      // Update active tab
      document.querySelectorAll('#patients-tabs a').forEach(tab => tab.classList.remove('active'));
      this.classList.add('active');
      
      // Show queue section, hide clinic logs and referral
      document.getElementById('queue-card').style.display = 'block';
      document.getElementById('clinic-logs-card').style.display = 'none';
      document.getElementById('referral-card').style.display = 'none';
      document.getElementById('basic-assessment-card').style.display = 'none';
    });
    
    document.getElementById('tab-cliniclogs').addEventListener('click', function(e) {
      e.preventDefault();
      
      // Update active tab
      document.querySelectorAll('#patients-tabs a').forEach(tab => tab.classList.remove('active'));
      this.classList.add('active');
      
      // Show clinic logs section, hide queue and referral
      document.getElementById('clinic-logs-card').style.display = 'block';
      document.getElementById('queue-card').style.display = 'none';
      document.getElementById('referral-card').style.display = 'none';
      document.getElementById('basic-assessment-card').style.display = 'none';
    });
    
    document.getElementById('tab-referral').addEventListener('click', function(e) {
      e.preventDefault();
      
      // Update active tab
      document.querySelectorAll('#patients-tabs a').forEach(tab => tab.classList.remove('active'));
      this.classList.add('active');
      
      // Show referral section, hide others
      document.getElementById('referral-card').style.display = 'block';
      document.getElementById('clinic-logs-card').style.display = 'none';
      document.getElementById('queue-card').style.display = 'none';
      document.getElementById('basic-assessment-card').style.display = 'none';
    });

    document.getElementById('tab-basic').addEventListener('click', function(e) {
      e.preventDefault();
      
      // Update active tab
      document.querySelectorAll('#patients-tabs a').forEach(tab => tab.classList.remove('active'));
      this.classList.add('active');
      
      // Show basic assessment section, hide others
      document.getElementById('basic-assessment-card').style.display = 'block';
      document.getElementById('clinic-logs-card').style.display = 'none';
      document.getElementById('queue-card').style.display = 'none';
      document.getElementById('referral-card').style.display = 'none';
    });

    // Referral inner tabs
    document.getElementById('ref-tab-create').addEventListener('click', function(e){
      e.preventDefault();
      document.querySelectorAll('#referral-tabs a').forEach(tab => tab.classList.remove('active'));
      this.classList.add('active');
      document.getElementById('referral-create').style.display = 'block';
      document.getElementById('referral-pending').style.display = 'none';
      document.getElementById('referral-approved').style.display = 'none';
    });
    document.getElementById('ref-tab-pending').addEventListener('click', function(e){
      e.preventDefault();
      document.querySelectorAll('#referral-tabs a').forEach(tab => tab.classList.remove('active'));
      this.classList.add('active');
      document.getElementById('referral-create').style.display = 'none';
      document.getElementById('referral-pending').style.display = 'block';
      document.getElementById('referral-approved').style.display = 'none';
    });
    document.getElementById('ref-tab-approved').addEventListener('click', function(e){
      e.preventDefault();
      document.querySelectorAll('#referral-tabs a').forEach(tab => tab.classList.remove('active'));
      this.classList.add('active');
      document.getElementById('referral-create').style.display = 'none';
      document.getElementById('referral-pending').style.display = 'none';
      document.getElementById('referral-approved').style.display = 'block';
    });
    
    // Reset modal to search state when opened
    document.getElementById('open-checkin').addEventListener('click', function() {
      // Reset modal to show search section first
      document.getElementById('search-section').style.display = 'block';
      document.getElementById('patient-section').style.display = 'none';
      
      // Clear any previous input
      document.getElementById('checkin-id').value = '';
    });
    
    // Show patient section after search
    document.getElementById('modal-search-btn').addEventListener('click', function() {
      const patientId = document.getElementById('checkin-id').value.trim();
      
      if (patientId === '') {
        alert('Please enter a Patient ID number');
        return;
      }
      
      document.getElementById('search-section').style.display = 'none';
      document.getElementById('patient-section').style.display = 'block';
    });
    
    // Show guardian details if yes
    document.getElementById('guardian-yes').addEventListener('change', function() {
      document.getElementById('guardian-details').style.display = 'block';
    });
    
    document.getElementById('guardian-no').addEventListener('change', function() {
      document.getElementById('guardian-details').style.display = 'none';
    });
    
    // Show upload section if yes
    document.getElementById('documents-yes').addEventListener('change', function() {
      document.getElementById('upload-section').style.display = 'block';
      document.getElementById('uploaded-files').style.display = 'block';
    });
    
    document.getElementById('documents-no').addEventListener('change', function() {
      document.getElementById('upload-section').style.display = 'none';
      document.getElementById('uploaded-files').style.display = 'none';
    });
    
    // Show success message and auto-hide after 2.5 seconds
    document.getElementById('btn-checkin-final').addEventListener('click', function() {
      console.log('CHECK - IN button clicked!'); // Debug log
      
      // Hide the guardian modal
      document.getElementById('guardian-modal').style.display = 'none';
      
      // Show success modal
      document.getElementById('success-modal').style.display = 'flex';
      
      // Auto-hide after 2.5 seconds
      setTimeout(function() {
        document.getElementById('success-modal').style.display = 'none';
        // Reset to main page
        window.location.hash = '';
      }, 2500);
    });
    
    // Alternative way to ensure the button works
    document.addEventListener('DOMContentLoaded', function() {
      const checkinBtn = document.getElementById('btn-checkin-final');
      if (checkinBtn) {
        console.log('CHECK - IN button found!'); // Debug log
        checkinBtn.addEventListener('click', function() {
          console.log('CHECK - IN button clicked via DOMContentLoaded!'); // Debug log
          
          // Hide the guardian modal
          document.getElementById('guardian-modal').style.display = 'none';
          
          // Show success modal
          document.getElementById('success-modal').style.display = 'flex';
          
          // Auto-hide after 2.5 seconds
          setTimeout(function() {
            document.getElementById('success-modal').style.display = 'none';
            // Reset to main page
            window.location.hash = '';
          }, 2500);
        });
      } else {
        console.log('CHECK - IN button NOT found!'); // Debug log
      }
      
      // Referral submit button functionality
      const referralSubmitBtn = document.getElementById('ref-submit');
      if (referralSubmitBtn) {
        referralSubmitBtn.addEventListener('click', function() {
          console.log('Referral submit button clicked!'); // Debug log
          
          // Validate form (basic validation)
          const purpose = document.getElementById('ref-purpose').value;
          const name = document.getElementById('ref-name').value;
          const age = document.getElementById('ref-age').value;
          const sex = document.getElementById('ref-sex').value;
          const address = document.getElementById('ref-address').value;
          const referredTo = document.getElementById('ref-to').value;
          
          if (!purpose || !name || !age || !sex || !address || !referredTo) {
            alert('Please fill in all required fields');
            return;
          }
          
          // Get selected requests
          const selectedRequests = [];
          const checkboxes = document.querySelectorAll('.ref-check input[type="checkbox"]:checked');
          checkboxes.forEach(checkbox => {
            const label = checkbox.parentElement.textContent.trim();
            selectedRequests.push(label);
          });
          
          // Store referral data for later use (you can expand this to save to database)
          const referralData = {
            patientName: name,
            purpose: purpose,
            referredTo: referredTo,
            selectedRequests: selectedRequests,
            age: age,
            sex: sex,
            address: address
          };
          
          // For demo purposes, store in sessionStorage
          sessionStorage.setItem('lastReferral', JSON.stringify(referralData));
          
          // Show referral success modal
          document.getElementById('referral-success-modal').style.display = 'flex';
          
          // Auto-hide after 2.5 seconds
          setTimeout(function() {
            document.getElementById('referral-success-modal').style.display = 'none';
          }, 2500);
          
          // Reset form
          document.getElementById('referral-form').reset();
        });
      } else {
        console.log('Referral submit button NOT found!'); // Debug log
      }
      
      // Filter functionality
      const applyFilterBtn = document.getElementById('apply-filter');
      if (applyFilterBtn) {
        applyFilterBtn.addEventListener('click', function() {
          applyFilters();
        });
      }
      // Referral filter functionality
      const applyFilterBtnRef = document.getElementById('apply-filter-ref');
      if (applyFilterBtnRef) {
        applyFilterBtnRef.addEventListener('click', function() {
          applyReferralFilters();
        });
      }
      
      // Filter button functionality
      const filterBtn = document.getElementById('filter-btn');
      if (filterBtn) {
        filterBtn.addEventListener('click', function() {
          const filterSection = document.getElementById('filter-section');
          if (filterSection.style.display === 'none') {
            filterSection.style.display = 'block';
          } else {
            filterSection.style.display = 'none';
          }
        });
      }
      // Referral filter button functionality
      const filterBtnRef = document.getElementById('filter-btn-ref');
      if (filterBtnRef) {
        filterBtnRef.addEventListener('click', function() {
          const filterSectionRef = document.getElementById('filter-section-ref');
          if (filterSectionRef.style.display === 'none') {
            filterSectionRef.style.display = 'block';
          } else {
            filterSectionRef.style.display = 'none';
          }
        });
      }
      
      // Close filter button functionality
      const closeFilterBtn = document.getElementById('close-filter');
      if (closeFilterBtn) {
        closeFilterBtn.addEventListener('click', function() {
          document.getElementById('filter-section').style.display = 'none';
        });
      }
      // Close referral filter button functionality
      const closeFilterBtnRef = document.getElementById('close-filter-ref');
      if (closeFilterBtnRef) {
        closeFilterBtnRef.addEventListener('click', function() {
          document.getElementById('filter-section-ref').style.display = 'none';
        });
      }
    });
    
    // Filter function
    function applyFilters() {
      const userFilter = document.getElementById('filter-users').value;
      const dateFilter = document.getElementById('filter-date').value;
      const statusFilter = document.getElementById('filter-status').value;
      const affiliationFilter = document.getElementById('filter-affiliation').value;
      
      const tableRows = document.querySelectorAll('#logs-table tbody tr');
      
      tableRows.forEach(row => {
        let showRow = true;
        
        // Filter by user (patient name)
        if (userFilter && userFilter !== '') {
          const patientName = row.cells[0].textContent.toLowerCase();
          if (!patientName.includes(userFilter.toLowerCase())) {
            showRow = false;
          }
        }
        
        // Filter by status
        if (statusFilter && statusFilter !== '') {
          const statusElement = row.querySelector('.status-badge');
          if (statusElement) {
            const status = statusElement.textContent.toLowerCase();
            if (status !== statusFilter.toLowerCase()) {
              showRow = false;
            }
          }
        }
        
        // Filter by affiliation (course)
        if (affiliationFilter && affiliationFilter !== '') {
          const course = row.cells[1].textContent.toLowerCase();
          if (!course.includes(affiliationFilter.toLowerCase())) {
            showRow = false;
          }
        }
        
        // Show/hide row based on filters
        row.style.display = showRow ? 'table-row' : 'none';
      });
      
      // Show filter results message
      const visibleRows = document.querySelectorAll('#logs-table tbody tr:not([style*="display: none"])');
      console.log(`Filter applied: ${visibleRows.length} results found`);
    }
    
    // Reset filters function
    function resetFilters() {
      document.getElementById('filter-users').value = '';
      document.getElementById('filter-date').value = '';
      document.getElementById('filter-status').value = '';
      document.getElementById('filter-affiliation').value = '';
      
      // Show all rows
      const tableRows = document.querySelectorAll('#logs-table tbody tr');
      tableRows.forEach(row => {
        row.style.display = 'table-row';
      });
    }

    // Referral filter function
    function applyReferralFilters() {
      const userFilter = document.getElementById('filter-users-ref').value;
      const statusFilter = document.getElementById('filter-status-ref').value;
      const affiliationFilter = document.getElementById('filter-affiliation-ref').value;

      const tableRows = document.querySelectorAll('#referral-table tbody tr');

      tableRows.forEach(row => {
        let showRow = true;

        // Filter by user (patient name)
        if (userFilter && userFilter !== '') {
          const patientName = row.cells[0].textContent.toLowerCase();
          if (!patientName.includes(userFilter.toLowerCase())) {
            showRow = false;
          }
        }

        // Filter by status
        if (statusFilter && statusFilter !== '') {
          const statusElement = row.querySelector('.status-badge');
          if (statusElement) {
            const status = statusElement.textContent.toLowerCase();
            if (status !== statusFilter.toLowerCase()) {
              showRow = false;
            }
          }
        }

        // Filter by affiliation (course)
        if (affiliationFilter && affiliationFilter !== '') {
          const course = row.cells[1].textContent.toLowerCase();
          if (!course.includes(affiliationFilter.toLowerCase())) {
            showRow = false;
          }
        }

        // Show/hide row based on filters
        row.style.display = showRow ? 'table-row' : 'none';
      });

      const visibleRows = document.querySelectorAll('#referral-table tbody tr:not([style*="display: none"])');
      console.log(`Referral filter applied: ${visibleRows.length} results found`);
    }
    
    // Function to show referral slip modal
    function showReferralSlip(patientName, purpose, referredTo, selectedRequests = []) {
      const modalContent = document.getElementById('referral-slip-content');
      const currentDate = new Date();
      const formattedDate = currentDate.toLocaleDateString('en-US', { 
        month: 'numeric', 
        day: 'numeric', 
        year: '2-digit' 
      });
      
      // Pull additional data from saved referral if available
      let ageVal = '';
      let sexVal = '';
      let addressVal = '';
      try {
        const storedReferral = sessionStorage.getItem('lastReferral');
        if (storedReferral) {
          const referralData = JSON.parse(storedReferral);
          if (referralData.patientName === patientName) {
            ageVal = referralData.age || '';
            sexVal = referralData.sex ? (referralData.sex.charAt(0).toUpperCase() + referralData.sex.slice(1)) : '';
            addressVal = referralData.address || '';
            if (selectedRequests.length === 0) {
              selectedRequests = referralData.selectedRequests || [];
            }
          }
        }
      } catch (e) {
        console.log('No stored referral data found');
      }
      
      modalContent.innerHTML = `
        <div class="referral-slip-header">
          <div class="institution-name">UNIVERSITY OF CEBU - MAIN CAMPUS</div>
          <div class="department-name">MEDICAL - DENTAL CLINIC</div>
          <div class="institution-address">Osmena Blvd. Corner Sancianko St., Cebu City</div>
          <div class="institution-contact">Tel. No. (032) 255-7777 Loc. 26</div>
        </div>
        
        <div class="referral-title">REFERRAL SLIP</div>
        
        <div class="referral-details">
          <div class="referral-form">
            <div class="referral-line">
              <div class="referral-field field-date">
                <span class="referral-label">Date :</span>
                <span class="referral-underline">${formattedDate}</span>
              </div>
            </div>

            <div class="referral-line">
              <div class="referral-field field-referred">
                <span class="referral-label">Referred to :</span>
                <span class="referral-underline">${referredTo}</span>
              </div>
              <div class="referral-field field-age">
                <span class="referral-label">Age :</span>
                <span class="referral-underline">${ageVal}</span>
              </div>
              <div class="referral-field field-sex">
                <span class="referral-label">Sex :</span>
                <span class="referral-underline">${sexVal}</span>
              </div>
            </div>

            <div class="referral-line">
              <div class="referral-field field-name">
                <span class="referral-label">Name :</span>
                <span class="referral-underline">${patientName}</span>
              </div>
            </div>

            <div class="referral-line line-address">
              <div class="referral-field field-address">
                <span class="referral-label">Address :</span>
                <span class="referral-underline">${addressVal}</span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="request-section">
          <div class="request-title">REQUEST FOR :</div>
          <div class="request-items">
            ${selectedRequests.map(request => `
              <div class="request-item">
                <input type="checkbox" class="request-checkbox" checked disabled>
                <span class="request-text">${request}</span>
              </div>
            `).join('')}
          </div>
        </div>
        
        <div class="physician-section">
          <div class="physician-name">DR. ROSALINE A. ROMALES</div>
          <div class="physician-title">University Physician</div>
          <div class="physician-license">Lic. No. 0031349</div>
        </div>
        
        <div class="verification-section">
          <div class="verification-text">
            The hospital may scan the QR code below for verification purposes (requires Internet connection).
          </div>
          <div class="verification-link">
            Valid QR Verification Link : https://referral.ucniacare.clinic.ph/clinic/Home/ViewSL
          </div>
          <div class="qr-code-placeholder">
            QR Code
          </div>
        </div>
      `;
      
      document.getElementById('referral-slip-modal').style.display = 'flex';
    }
    
    // Event listeners for referral slip modal
    document.addEventListener('DOMContentLoaded', function() {
      // Close referral slip modal when clicking the close button
      const referralSlipClose = document.getElementById('referral-slip-close');
      if (referralSlipClose) {
        referralSlipClose.addEventListener('click', function(e) {
          e.preventDefault();
          document.getElementById('referral-slip-modal').style.display = 'none';
        });
      }
      

      
             // Print referral slip functionality
       const printReferralBtn = document.getElementById('print-referral');
       if (printReferralBtn) {
         printReferralBtn.addEventListener('click', function() {
           window.print();
         });
       }
      
      // Basic Assessment functionality
      const assessButtons = document.querySelectorAll('.assess-btn');
      assessButtons.forEach(button => {
        button.addEventListener('click', function() {
          // Get patient data from the queue card
          const queueCard = this.closest('.queue-card');
          const patientName = queueCard.querySelector('.patient-name').textContent;
          const assessmentType = queueCard.querySelector('.assessment-type').textContent;
          
          // Update patient information section with the selected patient
          updatePatientInfo(patientName, assessmentType);
          
          // Scroll to patient information section
          document.querySelector('.patient-information-section').scrollIntoView({ 
            behavior: 'smooth',
            block: 'start'
          });
        });
      });
      
      // Submit assessment functionality
      const submitAssessmentBtn = document.querySelector('.submit-assessment-btn');
      if (submitAssessmentBtn) {
        submitAssessmentBtn.addEventListener('click', function() {
          // Validate required fields
          const requiredFields = document.querySelectorAll('.vital-input, .anthropometric-input');
          let isValid = true;
          
          requiredFields.forEach(field => {
            if (!field.value.trim()) {
              field.style.borderColor = '#dc2626';
              isValid = false;
            } else {
              field.style.borderColor = '#d1d5db';
            }
          });
          
          if (!isValid) {
            alert('Please fill in all required fields (marked with *)');
            return;
          }
          
          // Show success message
          alert('Assessment submitted successfully!');
          
          // Reset form
          requiredFields.forEach(field => {
            field.value = '';
          });
        });
      }
      
      // Function to update patient information
      function updatePatientInfo(patientName, assessmentType) {
        // Sample patient data - in a real app, this would come from a database
        const patientData = {
          'Nancy Romales': {
            name: 'Nancy Romales',
            address: 'Sitio Guinabsan, Basak San Nicolas',
            contact: '09310159072',
            guardian: 'Glenacy Romales',
            guardianContact: '09225265408',
            relationship: 'Mother',
            id: '22599559',
            age: '21',
            sex: 'Female',
            status: 'Single',
            birthdate: '09/10/03',
            course: 'BSIT - 4'
          },
          'Wincy Romales': {
            name: 'Wincy Romales',
            address: 'Sitio Guinabsan, Basak San Nicolas',
            contact: '09310159073',
            guardian: 'Glenacy Romales',
            guardianContact: '09225265408',
            relationship: 'Mother',
            id: '22599560',
            age: '19',
            sex: 'Female',
            status: 'Single',
            birthdate: '05/15/05',
            course: 'BSHM - 2'
          },
          'Glenn Romales': {
            name: 'Glenn Romales',
            address: 'Sitio Guinabsan, Basak San Nicolas',
            contact: '09310159074',
            guardian: 'Glenacy Romales',
            guardianContact: '09225265408',
            relationship: 'Mother',
            id: '22599561',
            age: '23',
            sex: 'Male',
            status: 'Single',
            birthdate: '03/20/01',
            course: 'BSCS - 4'
          },
          'Rachelle Fiel': {
            name: 'Rachelle Fiel',
            address: 'Cebu City',
            contact: '09310159075',
            guardian: 'Maria Fiel',
            guardianContact: '09225265409',
            relationship: 'Mother',
            id: '22599562',
            age: '20',
            sex: 'Female',
            status: 'Single',
            birthdate: '08/12/04',
            course: 'BEED - 3'
          }
        };
        
        const patient = patientData[patientName];
        if (patient) {
          // Update patient information fields
          const infoFields = document.querySelectorAll('.info-value');
          infoFields.forEach(field => {
            const label = field.previousElementSibling.textContent;
            switch(label) {
              case 'NAME:':
                field.textContent = patient.name;
                break;
              case 'ADDRESS:':
                field.textContent = patient.address;
                break;
              case 'CONTACT NO:':
                field.textContent = patient.contact;
                break;
              case 'NAME OF PARENT / GUARDIAN:':
                field.textContent = patient.guardian;
                break;
              case 'TEL. NO / CELL NO.:':
                field.textContent = patient.guardianContact;
                break;
              case 'RELATIONSHIP:':
                field.textContent = patient.relationship;
                break;
              case 'I.D. NO:':
                field.textContent = patient.id;
                break;
              case 'AGE:':
                field.textContent = patient.age;
                break;
              case 'SEX:':
                field.textContent = patient.sex;
                break;
              case 'STATUS:':
                field.textContent = patient.status;
                break;
              case 'BIRTHDATE:':
                field.textContent = patient.birthdate;
                break;
              case 'COURSE & YR:':
                field.textContent = patient.course;
                break;
            }
          });
        }
      }
    });
  </script>
</body>
</html>


